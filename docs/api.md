# VivintPy Core API Reference

## VivintSkyApi

**Constructor:** `__init__(self, username: str, password: str | None = None, refresh_token: str | None = None, client_session: aiohttp.ClientSession | None = None) -> None`
*Initialize the VivintSky API.*

**Important Notes:**
*   **Endpoints:** This API interacts with `API_ENDPOINT = "https://www.vivintsky.com/api"`, `AUTH_ENDPOINT = "https://id.vivint.com"`, and `GRPC_ENDPOINT = "grpc.vivintsky.com:50051"`.
*   **Common Exceptions:** Many methods can raise common exceptions:
    *   `VivintSkyApiError`: For general API errors.
    *   `VivintSkyApiAuthenticationError`: For issues related to login or token validation.
    *   `VivintSkyApiMfaRequiredError`: If Multi-Factor Authentication is required to proceed.
    *   `aiohttp.ClientResponseError`: For HTTP-level errors from the underlying `aiohttp` library.
    Specific exceptions are noted where particularly relevant.

**Properties:**

| Name   | Description                |
| ------ | -------------------------- |
| `tokens` | Return the tokens, if any. |

**Methods:**

| Name                                    | Signature                                                                                                                               | Description                                                                                                                                                                                                                                                           |
| --------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `connect`                               | `async def connect(self) -> AuthUserData`                                                                                               | Connect to VivintSky Cloud Service. Attempts to use `refresh_token` if available, otherwise uses username/password. <br/>**Raises:** `VivintSkyApiAuthenticationError`, `VivintSkyApiMfaRequiredError`.                                                              |
| `disconnect`                            | `async def disconnect(self) -> None`                                                                                                    | Disconnect from VivintSky Cloud Service. Closes the `aiohttp.ClientSession` if it was not provided externally.                                                                                                                                                      |
| `get_authuser_data`                     | `async def get_authuser_data(self) -> AuthUserData`                                                                                     | Get the authuser data. Polls the Vivint authuser API endpoint to gather user-related data, including an enumeration of the systems the user has access to. Returns an `AuthUserData` Pydantic model.                                                              |
| `get_camera_thumbnail_url`              | `async def get_camera_thumbnail_url(self, panel_id: int, partition_id: int, device_id: int, thumbnail_timestamp: int) -> dict \| None`    | Get the camera thumbnail URL. Returns a dictionary like `{"url": "https://..."}` or `None` on failure. <br/>**Note:** You typically need to call `request_camera_thumbnail` first.                                                                                 |
| `get_device_data`                       | `async def get_device_data(self, panel_id: int, device_id: int) -> dict \| None`                                                       | Get the raw data for a specific device. The structure of the returned dictionary varies depending on the device type.                                                                                                                                                 |
| `get_panel_credentials`                 | `async def get_panel_credentials(self, panel_id: int) -> PanelCredentialsData`                                                          | Get the panel credentials required for PubNub or other direct panel interactions. Returns a `PanelCredentialsData` Pydantic model.                                                                                                                                    |
| `get_system_data`                       | `async def get_system_data(self, panel_id: int) -> SystemData`                                                                          | Get the raw data for an entire system (panel), including all its devices. Returns a `SystemData` Pydantic model.                                                                                                                                                    |
| `get_system_update`                     | `async def get_system_update(self, panel_id: int) -> PanelUpdateData \| None`                                                           | Get panel software update details. Returns a `PanelUpdateData` Pydantic model or `None`.                                                                                                                                                                              |
| `is_session_valid`                      | `def is_session_valid(self) -> bool`                                                                                                    | Return `True` if the current session's ID token is still valid (not expired), `False` otherwise.                                                                                                                                                                  |
| `reboot_camera`                         | `async def reboot_camera(self, panel_id: int, device_id: int, device_type: str) -> None`                                                 | Reboot a camera. Uses gRPC.                                                                                                                                                                                                                                           |
| `reboot_panel`                          | `async def reboot_panel(self, panel_id: int) -> None`                                                                                   | Reboot a panel.                                                                                                                                                                                                                                                       |
| `refresh_token`                         | `async def refresh_token(self, refresh_token: str) -> None`                                                                             | Refresh the authentication token using a `refresh_token`. <br/>**Raises:** `VivintSkyApiAuthenticationError`.                                                                                                                                                         |
| `request_camera_thumbnail`              | `async def request_camera_thumbnail(self, panel_id: int, partition_id: int, device_id: int) -> None`                                     | Request the camera to generate a new thumbnail. After calling this, poll `get_camera_thumbnail_url`.                                                                                                                                                                  |
| `set_alarm_state`                       | `async def set_alarm_state(self, panel_id: int, partition_id: int, state: int) -> None`                                                  | Set the alarm state. The `state` parameter should be a value from `vivintpy.enums.ArmedState` (e.g., `ArmedState.DISARMED.value`, `ArmedState.ARMED_STAY.value`, `ArmedState.ARMED_AWAY.value`).                                                                  |
| `set_camera_as_doorbell_chime_extender` | `async def set_camera_as_doorbell_chime_extender(self, panel_id: int, device_id: int, state: bool) -> None`                               | Set whether a camera is used as a doorbell chime extender. `state=True` to enable, `state=False` to disable. Uses gRPC.                                                                                                                                        |
| `set_camera_deter_mode`                 | `async def set_camera_deter_mode(self, panel_id: int, device_id: int, state: bool) -> None`                                              | Set the camera deter mode (e.g., lights/sound on motion). `state=True` to enable, `state=False` to disable. Uses gRPC.                                                                                                                                           |
| `set_camera_privacy_mode`               | `async def set_camera_privacy_mode(self, panel_id: int, device_id: int, state: bool) -> None`                                            | Set the camera privacy mode (camera off). `state=True` to enable privacy, `state=False` to disable. Uses gRPC.                                                                                                                                                |
| `set_garage_door_state`                 | `async def set_garage_door_state(self, panel_id: int, partition_id: int, device_id: int, state: int) -> None`                           | Open or Close a garage door. The `state` parameter should be a value from `vivintpy.enums.GarageDoorState` (e.g., `GarageDoorState.CLOSED.value`, `GarageDoorState.OPEN.value`).                                                                                   |
| `set_lock_state`                        | `async def set_lock_state(self, panel_id: int, partition_id: int, device_id: int, locked: bool) -> None`                                | Lock (`locked=True`) or Unlock (`locked=False`) a door lock.                                                                                                                                                                                                      |
| `set_sensor_state`                      | `async def set_sensor_state(self, panel_id: int, partition_id: int, device_id: int, bypass: bool) -> None`                              | Bypass (`bypass=True`) or unbypass (`bypass=False`) a sensor. This translates to `vivintpy.enums.ZoneBypass` values internally.                                                                                                                                    |
| `set_switch_state`                      | `async def set_switch_state(self, panel_id: int, partition_id: int, device_id: int, on: bool \| None = None, level: int \| None = None) -> None` | Set switch state. For on/off switches, use `on=True` or `on=False`. For dimmers, use `level` (0-100) to set brightness; `on=True` can also be used to turn on to the last brightness, and `on=False` to turn off. At least one of `on` or `level` must be provided. | 
| `set_thermostat_state`                  | `async def set_thermostat_state(self, panel_id: int, partition_id: int, device_id: int, **kwargs: Any) -> None`                         | Set thermostat state. Common `kwargs` include: `heat_setpoint` (float), `cool_setpoint` (float), `fan_mode` (value from `vivintpy.enums.ThermostatFanMode`), `operating_mode` (value from `vivintpy.enums.ThermostatOperatingMode`).                               |
| `trigger_alarm`                         | `async def trigger_alarm(self, panel_id: int, partition_id: int) -> None`                                                               | Trigger an alarm (panic alarm).                                                                                                                                                                                                                                           |
| `update_panel_software`                 | `async def update_panel_software(self, panel_id: int) -> None`                                                                          | Request a panel software update.                                                                                                                                                                                                                                      |
| `verify_mfa`                            | `async def verify_mfa(self, code: str) -> None`                                                                                         | Verify multi-factor authentication code. <br/>**Raises:** `VivintSkyApiAuthenticationError` if the code is invalid.                                                                                                                                                 |

